---
title: "Modular Arithmetic in R"
author: "Math 376"
date: "Spring 2021"
output: html_document
---

We will include the `pracma` package. You may need to search for this package under Packages and Install in the bottom right window of your RStudio frame. Pracma stands for practical math applications and it includes the `mod` function that we will use. 
```{r,echo=TRUE,warning=FALSE}
require(pracma)
```





## $\mathbb{Z}_n$: Integers Mod n under addition

The functions `idivide` and `mod` (in pracma) gives the quotient and remainder mod n. So for example,
```{r}
idivide(56,17)
mod(56,17)
```
Since 3*17 + 5 = 56 as seen here
```{r}
3*17+5
```

We can generate the finite **cyclic** group $\mathbb{Z}_n = \{0, 1, 2, \ldots, n-1\}$ easily as follows:

```{r,echo=TRUE}
n = 12
G = 0:(n-1)  # generates an integer sequence from 0 to n-1.
G
```

And then we can add all of these elements mod n and make the **Cayley table** as follows: 
```{r,echo=TRUE}
n=6
G = 0:(n-1)
T = mod(outer(G,G,"+"),n)  # the outer sum computes a table of sums i + j. The mod command views them mod n.
rownames(T) = G
colnames(T) = G
T
```

Even better, we can write a little function to do this.

```{r,echo=TRUE}
CyclicCayley <- function(n,op="+") {
  G = 0:(n-1)
  T = mod(outer(G,G,op),n)
  rownames(T) = G
  colnames(T) = G
  return(T) 
  }
```

Then 

```{r,echo=TRUE}
CyclicCayley(5)
```
and 

```{r,echo=TRUE}
CyclicCayley(15)
```

### You Try

a. Find the order of 5 (i.e. |5|) in $\mathbb{Z}_{17}$. Hint: You could compute the Cayley table, or you could find the first 10 multiples of 5 by computing `5*(0:10)` and view it mod 17.

b. When does $\mathbb{Z}_n$ have an element of order 2? Look at some example Cayley tables to help you decide. 







## Multiplication Mod n

The multiplicative group U(n) under multiplication mod n is 
$$
U(n) = \{ 1 \le k < n \mid gcd(k,n) = 1 \}.
$$
These are the numbers relatively prime to n. There are commands and functions for working with this group in the Modular Arithmetic section of the Math 376 Handbook. Look at those commands to answer the following questions. 


a. Find d = gcd(420,1170) and use the extended gcd to write
$$
d = s 420 + t 1170
$$

b. Look at the code in the handbook and use it to make the multiplication tables for U(10), U(13), U(24). The integer 7 is relatively prime to 10, 13, and 17, so it is in U(10), U(13), and U(17). By looking at the tables, what is the inverse of 7 in each of these groups. 


c. Suppose that you want to find the multiplicative inverse of 457 mod 2021. That is the inverse of 457 in U(2021). One could make the table, but it is very big. Instead, do the following.

    (i) First use the extended GCD to write 1 = s 457 + t 2021.
    
    (ii) Now, think of what that previous statement tells you if you view it mod 2021. It gives you the multiplicative inverse.
    
    (iii) Double check the inverse by multiplying 457 by that number and viewing it mod 2021.







## $GL_m(\mathbb{Z}_n)$: Modular Matrix Multiplication

We can also view matrices mod n. That is, we can consider the group of $2 \times 2$ matrices $GL_2(\mathbb{Z}_n)$ with entries chosen from the integers mod n, and all arithmetic done mod n.

For example, consider the following two matrices
```{r}
A = cbind(c(1,2),c(1,1))
A
B = cbind(c(2,2),c(1,2))
B
```

We can compute their mod 3 determinant as follows and see that they are invertible
```{r}
mod(det(A),3)
mod(det(B),3)
```

Recall that in R, matrix multiplication uses the funny operator `%*%`. If you just use `*` it will multiply entry by entry rather than use matrix multiplication. We can square A mod 3 
```{r}
mod(A%*%A,3)
```

And we can multiply AB mod 3

```{r}
mod(A%*%B,3)
```
revealing that they are inverses mod 3. But they are not inverses over R as we see here
```{r}
A %*% B
```

### You try

a. Find the order of the matrix below in $\mathbb{Z}_2, \mathbb{Z}_3, \mathbb{Z}_4, \ldots$

```{r}
A = cbind(c(1,0),c(1,1))
```

b. Find the order of the matrix below in $\mathbb{Z}_5$. And find its inverse. 

```{r}
A = cbind(c(1,2),c(3,4))
```

c. Work on problem 1.3 in PS1.
